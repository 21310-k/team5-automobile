H8S,H8/300 SERIES C/C++ COMPILER (V.6.02.01.000)   27-Nov-2024 18:53:33 PAGE   1

************ SOURCE LISTING ************

      Line Pi 0----+----1----+----2----+----3----+----4----+----5----+----6----+----7----+----8----+----9----+----0----+----1----+--
FILE NAME: C:\Users\s4exp\Desktop\soft2-20241127T060649Z-001\soft2\Soft2\itask_input.c
         1     /****************************************************************************************************************/
         2     /*  FILE        : itask_input.c                                                                                 */
         3     /*  DATE        :Tue, Jan 17, 2012                                                                              */
         4     /*  DESCRIPTION :AGVの入力割り込みタスク                                                                        */
         5     /*  CPU TYPE    :H8/3052F                                                                                       */
         6     /****************************************************************************************************************/
         7     #include    "machine.h"                             /* 組込み関数の定義                                         */
         8     #include    "reg3052.h"                             /* H8/3052Fの内蔵モジュール定義                             */
         9     #include    "agvdef.h"                              /* 無人搬送車のデバイス定義                                 */
        10     #include    "agvvars.h"                             /* 無人搬送車の共通変数を定義                               */
        11     #include    "def_monitor_printf.h"
        12     
        13     /****************************************************************************************************************/
        14     /*  入力タスク itask_input                                                                                      */
        15     /****************************************************************************************************************/
        16     #pragma interrupt itask_input
        17     void    itask_input(void)
        18     {
        19         static unsigned char a = 0x00, b = 0x00;
        20         unsigned char x,y,c,timer=0;
        21         static int count_error=0;
        22         static char count_sens = 0,count_sw=0;
        23         
        24     /*センサーの読み取り*/
        25     
        26     /*100ms以上で走行アラーム状態へ*/
        27         if (bios_sensor_input()==0x00) 
        28         {
        29             count_error++;
        30         
        31             if (count_error >= 3) 
        32             {
        33                 SENS_ERROR = 0x01;
        34                 count_error = 0;
        35             }
        36         }
        37         
        38     /*チャタリングを防ぐ*/
        39     
        40         x = bios_sensor_input();
        41             
        42         if (x == 0)
        43         {
        44             count_sens++;
        45         
        46             if(count_sens>=5)
        47             {
        48                 SENS_DATA = x;
        49                 count_sens=0;
        50             }
        51         }
        52         else 
        53         {
        54             count_sens = 0;
        55             SENS_DATA=x;
        56             SENS_ERROR=0;
        57         }
        58     
        59     /*スイッチの読み取り*/
        60         y = bios_sw_input();
        61     
        62         if (y == b) 
        63         {
        64             count_sw = 0;
        65             b = y;
        66         }
        67         else 
        68         {
        69             count_sw++;
        70     
        71             if (count_sw >= 0)
        72             {
        73                 SW_DATA = y;
        74             }
        75         }
        76         
        77         TSR3&=~0x01;
        78     }


H8S,H8/300 SERIES C/C++ COMPILER (V.6.02.01.000)   27-Nov-2024 18:53:33 PAGE   1

******* SECTION SIZE INFORMATION *******

PROGRAM  SECTION(P):                                0x000000A4 Byte(s)
CONSTANT SECTION(C):                                0x00000000 Byte(s)
DATA     SECTION(D):                                0x00000006 Byte(s)
BSS      SECTION(B):                                0x00000000 Byte(s)

TOTAL PROGRAM  SECTION: 0x000000A4 Byte(s)
TOTAL CONSTANT SECTION: 0x00000000 Byte(s)
TOTAL DATA     SECTION: 0x00000006 Byte(s)
TOTAL BSS      SECTION: 0x00000000 Byte(s)

    TOTAL PROGRAM SIZE: 0x000000AA Byte(s)



** ASSEMBLER/LINKAGE EDITOR LIMITS INFORMATION **

NUMBER OF EXTERNAL REFERENCE  SYMBOLS:        5 
NUMBER OF EXTERNAL DEFINITION SYMBOLS:        1 
NUMBER OF INTERNAL/EXTERNAL SYMBOLS:         17 



**** COMPILE CONDITION INFORMATION ****

COMMAND LINE: -cpu=300HA:20 -object=C:\Users\s4exp\Desktop\soft2-20241127T060649Z-001\soft2\Soft2\Debug\itask_input.obj -debug -list=C:\Users\s4exp\Desktop\soft2-20241127T060649Z-001\soft2\Soft2\Debug\itask_input.lst -show=tab=4 -chgincpath C:\Users\s4exp\Desktop\soft2-20241127T060649Z-001\soft2\Soft2\itask_input.c -lang=c -nologo
CPU         : 300ha:20
